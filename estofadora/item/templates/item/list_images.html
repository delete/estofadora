{% extends "base.html" %}

{% block extra_js %}
<script>
    $('.picture-formset').formset({
        addText: 'Adicionar imagem',
        deleteText: 'Remover'
    });
</script>
{% endblock %}

{% block content %}
<div class="panel panel-default">
    <div class="panel-body">
        <h3>
        	<p class="text-center">
        		Imagens de {{ item }}
        		<small>{{item.client.name}}</small>
        	</p>
        </h3>
    </div>
</div>

<div class="well well-sm">
    <form enctype="multipart/form-data" method="post">
        {% csrf_token %}
        {{ picture_formset.management_form }}
        <legend>Enviar images</legend>
        <div class="pictures">
        {% for form in picture_formset %}
                
                <div class="picture-formset">
                {{ form.image.label_tag }}
                {{ form.image }}
                <label for="id_pictures-<%= _id %>-DELETE">Apagar:</label>
                <input id="id_pictures-<%= _id %>-DELETE" name="pictures-<%= _id %>-DELETE" type="checkbox">
                <input id="id_pictures-<%= _id %>-item" name="pictures-<%= _id %>-item" type="hidden">
                <input id="id_pictures-<%= _id %>-id" name="pictures-<%= _id %>-id" type="hidden">
                </div>
                {% if form.image.errors %}
                    {% for error in form.image.errors %}
                        {{ error|escape }}
                    {% endfor %}
                {% endif %}
            
        {% endfor %}
        </div>
        <div>
            <button class="btn btn-primary form-control" 
                type="submit">Enviar
            </button>
        </div>
    </form>
</div>

<div class="row">
	{% for picture in pictures %}
    <div class="col-md-3 portfolio-item">
        <a target="_blank" href="{{picture.image.url}}">
            <img src="{{picture.image.url}}" class="img-responsive img-thumbnail item-image">
        </a>
	    <a class="btn btn-danger btn-xs" role="button" 
			href="{% url 'item:image_delete' picture.pk %}">Apagar 
		</a>
    </div>
    {% endfor %}
</div>

<div>
	<a class="btn btn-default" role="button" 
		href="{% url 'client:list_items' item.client.pk %}">Voltar 
	</a>
	<br>
	<br>
</div>

{% endblock %}